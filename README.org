#+TITLE: Siren
#+DATE: <2026-02-24 Mon>

*If there's a speaker, Siren will play sound.*

#+BEGIN_SRC carp
(load "siren.carp")

(defn main []
  (let-do [mix (Mixer.make 2)]
    (Mixer.set-channel! &mix 0 (lead-triangle 0.5f))
    (Mixer.set-seq!     &mix 0 (Seq.make [(note note-c4 200)
                                          (note note-e4 200)
                                          (note note-g4 400)]))
    (Mixer.set-channel! &mix 1 (bass-saw 0.4f))
    (Mixer.set-seq!     &mix 1 (Seq.make [(note note-c3 800)]))
    (Siren.init)
    (Siren.run &mix)))
#+END_SRC

That's it. Define instruments, define melodies, play them together. Anywhere.

* What It Is

Siren is a chiptune audio engine written in [[https://github.com/carp-lang/Carp][Carp]]. It compiles to C and
depends only on SDL2 — the same library that powers Carp's game ecosystem.
No runtime. No garbage collector. No proprietary dependencies. No license fees.

SDL2 runs on everything worth running on: desktop, Raspberry Pi, embedded ARM,
handheld hardware, art installations, homebrew game consoles. If someone cared
enough to hook up a speaker, SDL2 probably already runs there. So does Siren.

This is the point. Not a feature list — just this: *if there's a speaker, Siren
will play sound.* Minimal code, any hardware, real music.

* Why It Exists

Most audio engines are either:
- *Massive frameworks* (FMOD, Wwise) — proprietary, expensive, overkill
- *Runtime-dependent* (Python, JS) — not truly embeddable
- *Engine-locked* (Unity, Godot audio) — useless outside their host

Siren is none of those. It's a library. You own it completely.

It was built as part of an ongoing effort to make [[https://github.com/carp-lang/Carp][Carp]] viable as a general
purpose systems language — proving that a compiled Lisp with no GC can power
real audio DSP cleanly and ergonomically.

* The Pipeline

#+BEGIN_SRC
Sequencer → Oscillator → Envelope → [Filters] → Mixer → SDL2 → PCM out
#+END_SRC

Every stage is a pure transform on f32 arrays. Data flows one direction.
Ownership is linear. Nothing is shared between stages.

* What You Get

- *5 oscillators* — sine, square, saw, triangle, noise
- *ADSR envelopes* — full state machine, retrigger-safe
- *Biquad filters* — low-pass, high-pass, band-pass per channel
- *Step sequencer* — note arrays with rests, loops continuously
- *Polyphonic mixer* — N named voices + stereo pan + output clamp
- *Fire-and-forget SFX* — ~(Mixer.sfx! &mix freq instrument)~, no slot management
- *Preset instruments* — ~(pluck-square 0.4f)~, ~(pad-sine 0.3f)~, ~(bass-saw 0.5f)~
- *88 named notes* — ~note-c4~ through ~note-b7~, all piano keys
- *One-line startup* — ~Siren.run~ owns the engine loop

* Dependencies

- [[https://github.com/carp-lang/Carp][Carp]] — the compiler
- [[https://www.libsdl.org/][SDL2]] — audio output (already required by Carp game projects)

SDL2 is the right choice here — it's already the foundation of Carp's game
ecosystem, so Siren costs nothing extra to include in a Carp game. If Siren
ever needs to run somewhere truly headless (no display, no input, bare metal
audio only), the backend can be swapped to [[https://github.com/mackron/miniaudio][miniaudio]] — a single-header C
library — without touching anything else. The abstraction is already there.

* Status

Functional and tested. 72 tests, all passing. Real polyphonic music plays.
The architecture is proven. Not production-hardened — this is a research
project and a love letter to a language that deserves more users.

* Built With

sqrew + Claude (claude-sonnet-4-6) — southern Maine, 2026.
